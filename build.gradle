group 'scala-gradle-cucumber'
version '1.0-SNAPSHOT'

apply plugin: 'base'
apply plugin: 'java'
apply plugin: 'scala'

sourceCompatibility = 1.8

repositories {
    mavenCentral()
}

configurations {
    cucumberRuntime {
        extendsFrom testRuntime
    }
}

dependencies {
    compile     'org.scala-lang:scala-library:2.11.8'
    compile     'info.cukes:cucumber-scala_2.11:1.2.5'
    testCompile 'junit:junit:4.12'
    testCompile 'info.cukes:cucumber-junit:1.2.5'
    testCompile 'org.scalatest:scalatest_2.11:3.0.5'
}

task "store-runner"(type: JavaExec) {
    main = "cucumber.api.cli.Main"
    classpath = configurations.cucumberRuntime + sourceSets.main.output + sourceSets.test.output
    args = ['--plugin', 'pretty', '--glue', 'com.knoldus', 'src/test/resources']
}

task spec(dependsOn: ['testClasses'], type: JavaExec) {
    main = 'org.scalatest.tools.Runner'
    args = ['-R', 'build/classes/test', '-o']
    classpath = sourceSets.test.runtimeClasspath
}

test.dependsOn spec
build.dependsOn(test, "store-runner")